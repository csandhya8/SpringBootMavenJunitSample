
name: Upload dummy zip to JFrog

on:
  workflow_dispatch:

jobs:
  upload:
    runs-on: ubuntu-latest
    steps:
      - name: Create dummy zip
        run: |
          mkdir -p demo && echo "hello" > demo/hello.txt
          zip -r demo.zip demo

      - name: Upload to JFrog via REST
        env:
          JFROG_URL: https://trial7091u2.jfrog.io/artifactory/api/maven/
          REPO: test            # e.g., generic-local
          ARTIFACT_PATH: demos/${{ github.run_id }}/demo.zip
          ACCESS_TOKEN: ${{ secrets.JFROG_ACCESS_TOKEN }}
        run: |
          curl -H "Authorization: Bearer $ACCESS_TOKEN" \
               -T demo.zip \
               "$JFROG_URL/artifactory/$REPO/$ARTIFACT_PATH"

      - name: Verify upload
        env:
          JFROG_URL: https://<your-jfrog-url>
          REPO: <repo-name>
          ARTIFACT_PATH: demos/${{ github.run_id }}/demo.zip
          ACCESS_TOKEN: ${{ secrets.JFROG_ACCESS_TOKEN }}
        run: |
          curl -H "Authorization: Bearer $ACCESS_TOKEN" \
               -I "$JFROG_URL/artifactory/$REPO/$ARTIFACT_PATH"
